---
sidebar_position: 3
---

import BuckU2Diagram from '../_fragments/buck-u2-diagram.mdx';
import BuckU3Diagram from '../_fragments/buck-u3-diagram.mdx';
import CircuitSvg from '@site/src/components/CircuitSvg';
import Diagram1Svg from '@site/static/circuits/diagram1-usb-pd.svg';

# Circuit Diagrams

Complete circuit configuration shown in stages.

## Diagram1: USB-PD Power Supply Section

### Diagram1-1: USB-C Connector to CH224D IC (Complete Connection)

<CircuitSvg
  src={Diagram1Svg}
  alt="USB-C Connector J1"
  padding="10px"
/>

<details>
<summary>View ASCII art version</summary>

```
USB-C Connector J1 (6-pin power-only):
┌─────────────────────────────┐
│  2, 5  VBUS  ───────────────┼──→ VBUS Rail (5V initially, 15V after PD)
│                             │
│  3     CC1   ───────────────┼──→ To CH224D CC1
│  4     CC2   ───────────────┼──→ To CH224D CC2
│                             │
│  1, 6  GND   ───────────────┼──→ System GND
└─────────────────────────────┘

CH224D IC (QFN-20) - USB PD Sink Controller:
                    ┌──────────────────────────────┐
VBUS (5V→15V) ──────┤ 2. VBUS (Power I/O)          │
                    │                              │
                 ┌──┤11. CC1 (PD Comm)             │──→ To USB-C CC1
                 │  │10. CC2 (PD Comm)             │──→ To USB-C CC2
                 │  │                              │
                 │  │ 1. DRV  ──┬──────────────────│
                 │  │19. CFG1 ──┘                  │
                 │  │13. CFG2 ── Open              │
                 │  │12. CFG3 ── Open              │
                 │  │                              │
                 │  │ 8. DP   ──┬──────────────────│  ← SHORT together
                 │  │ 9. DM   ──┘                  │  ← (PD-only mode)
                 │  │                              │
                 │  │ 7. VDD (4.7V LDO)            │──→ C30 (1µF) ──→ GND
                 │  │                              │
                 │  │ 5. GATE (Internal Switch)    │ ── NC (internal use only)
                 │  │ 6. NMOS# (Ext Switch Ctrl)   │──→ GND (not using ext)
                 │  │                              │
                 │  │14. ISP (Current Sense +) ──┬─│
                 │  │15. ISN (Current Sense -) ──┘ │──→ GND (not using)
                 │  │                              │
                GND │ 0. GND (EPAD)                │
                    └──────────────────────────────┘

CRITICAL: VBUS is both input AND output!
- Initially: VBUS = 5V (default USB)
- After PD negotiation: VBUS = 15V (requested voltage)
- Pin 18 is NC (Not Connected) - NO separate output pin!
- Downstream circuits connect directly to VBUS

Input Filter Capacitors (on VBUS rail):
J1 VBUS ──┬────────────────┬─── CH224D pin 2 (VBUS) ──→ +15VOUT (to DC-DC stages)
          │                │
         C1               C2
       10µF            100nF
   electrolytic       ceramic
    (farther)        (CLOSE!)
          │                │
         GND              GND

- C1 (10µF electrolytic): Bulk filtering for both input 5V and output 15V
- C2 (100nF ceramic): High-frequency decoupling, placed CLOSE to CH224D pin 2
- Both capacitors filter the VBUS rail (voltage changes from 5V → 15V after PD)

VDD Decoupling (Internal 4.7V Regulator):
VDD (pin 7) ─── C30 (1µF) ──→ GND  (Close to IC)

CC Pin Pull-down Resistors (USB-PD Sink Identification):
CC1 (pin 11) ───┬─── R12 (5.1kΩ) ──→ GND
                │
                └──→ To USB-C CC1 (pin 3)

CC2 (pin 10) ───┬─── R13 (5.1kΩ) ──→ GND
                │
                └──→ To USB-C CC2 (pin 4)

Note: 5.1kΩ pull-downs identify device as USB-PD sink (power consumer)
```

### Diagram1-2: Voltage Configuration (15V Selection via Rset)

```
Rset Configuration Circuit:

DRV (pin 1) ──┬── CFG1 (pin 19)  ← These pins connected together
              │
             R11 (Rset = 56kΩ, 0603, ±0.1%)
              │
             GND

How it works:
1. DRV pin provides weak drive output
2. Resistor value determines voltage at CFG1
3. CH224D reads CFG1 voltage to determine requested voltage

CFG2 (pin 13) ── Open (or GND)  ← Not connected in resistor mode
CFG3 (pin 12) ── Open (or GND)  ← Not connected in resistor mode

Voltage Selection Table:
┌──────────┬──────────────────┐
│ R11 Value│ Requested Voltage│
├──────────┼──────────────────┤
│ 6.8 kΩ   │ 9V               │
│ 24 kΩ    │ 12V              │
│ 56 kΩ    │ 15V ✅ (This)    │
│ NC       │ 20V              │
└──────────┴──────────────────┘
```

### Diagram1-3: USB PD Negotiation Process

```
Step-by-step PD negotiation sequence:

1. Initial Connection (0-100ms):
   ┌─────────┐                    ┌─────────┐
   │ USB-C   │ ─── VBUS (5V) ───→ │ CH224D  │
   │ PD      │                    │  Sink   │
   │ Adapter │ ← CC1/CC2 pins  ─→ │         │
   └─────────┘   (with 5.1kΩ Rd)  └─────────┘

   VBUS = 5V (default USB voltage)
   CC pull-downs identify device as sink

2. Capability Discovery (100-200ms):
   CH224D requests available voltages via CC communication
   PD Adapter responds: 5V, 9V, 12V, 15V, 20V profiles

3. Voltage Request (200-300ms):
   CH224D requests 15V (based on R11 = 56kΩ configuration)

4. Acceptance & Voltage Transition (300-1000ms):
   PD Adapter accepts request
   VBUS transitions: 5V → 15V

5. Power Ready (>1000ms):
   VBUS stable at 15V
   System can draw up to 45W (15V × 3A)
   PG pin goes LOW (power good indicator)

CRITICAL: VBUS voltage changes from 5V to 15V on the same pin!
          There is NO separate output pin.
```

### Diagram1-4: Power Good (PG) LED Indicator

```
                                    CH224D IC (QFN-20)
                                    ┌─────────────────────┐
                                    │                     │
                                    │ 8. PG (Open-drain)  │
                                    │                     │
                                    └──────────┬──────────┘
                                               │
┌─────────────┐     ┌─────────┐     ┌──────────┐
│ +5V Rail    │     │   R10   │     │  LED1    │
│ (from D7)   ├─────┤  330Ω   ├─────┤  Green   ├──────────┘
└─────────────┘     └─────────┘     └──────────┘

Operation:
- PG pin is open-drain output
- When power negotiation succeeds: PG pulls LOW
- Current flows: +5V → R10 → LED1 → PG → GND
- LED current: I = (5V - 2.2V) / 330Ω ≈ 8.5mA ✅
```

### Diagram1-5: Internal Switch & Current Sensing Configuration

```
Internal Power Switch (GATE & NMOS#):
                                CH224D IC (QFN-20)
                    ┌───────────────────────────────────┐
                    │                                   │
VBUS (input) ───────┤ 2. VBUS                           │
                    │                                   │
                    │ 5. GATE ──→ Internal NMOS ────────┤──→ VBUS (output)
                    │              (Built-in switch)    │    (15V after PD)
                    │                                   │
               GND ─┤ 6. NMOS# (Ext Switch Control)     │
                    │   ↑                               │
                    │   └─ Tied to GND (not using       │
                    │      external MOSFET)             │
                    │                                   │
                    └───────────────────────────────────┘

**Internal Switch Operation:**
- CH224D has built-in N-channel MOSFET between VBUS input and output
- Pin 5 (GATE) drives the internal MOSFET gate
- For our 15V/3A application, internal switch is sufficient (up to 5A capability)
- **Pin 6 (NMOS#) tied to GND** = Use internal switch only

**External Switch Option (Not Used):**
- For higher current (>5A), you can use external MOSFET
- Pin 5 (GATE) would drive external MOSFET gate
- Pin 6 (NMOS#) would be configured differently
- We don't need this for our 3A max design

Current Sensing (ISP & ISN):
                                CH224D IC (QFN-20)
                    ┌───────────────────────────────────┐
                    │                                   │
                    │14. ISP (Current Sense +) ────────┼─┐
                    │15. ISN (Current Sense -) ────────┘ │
                    │                                     └─→ GND
                    └───────────────────────────────────┘

**Current Sensing Operation:**
- ISP/ISN pins can monitor current through the power path
- Useful for overcurrent protection or current limiting
- **Shorted together and tied to GND** = Not using current sensing
- CH224D still provides overcurrent protection via internal monitoring

**Our Configuration Summary:**
- ✅ Using internal MOSFET switch (sufficient for 3A)
- ✅ Pin 6 (NMOS#) → GND
- ✅ Pins 14, 15 (ISP, ISN) → Shorted together → GND
- ✅ No external components needed for these pins
```

</details>

<details>
<summary>Connection List</summary>

**CRITICAL Understanding:**
- VBUS is BOTH input (initially 5V) AND output (15V after negotiation)
- Pin 18 is NC - there is NO separate output pin!
- Downstream circuits (U2, U3, U4) connect directly to VBUS

**Power Rail (VBUS):**
- `USB-C VBUS (pins 2, 5)` → `CH224D pin 2 (VBUS)` → `VBUS Rail`
  - Initially: VBUS = 5V (default USB voltage)
  - After PD negotiation: VBUS = 15V (requested voltage)
  - This SAME pin serves as power output to DC-DC converters

**CC Communication Lines (USB-PD Protocol):**
- `USB-C CC1 (pin 3)` → `CH224D pin 11 (CC1)` → `R12 (5.1kΩ)` → `GND`
- `USB-C CC2 (pin 4)` → `CH224D pin 10 (CC2)` → `R13 (5.1kΩ)` → `GND`
- **Critical**: 5.1kΩ pull-downs (Rd) identify device as USB-PD sink

**Ground:**
- `USB-C GND (pins 1, 6)` → `System GND` → `CH224D pin 0 (EPAD)` (thermal pad)

**Input Filter Capacitors:**
- `C1 (10µF/25V electrolytic)`: `VBUS` ⟷ `GND` (bulk filtering)
- `C2 (100nF ceramic)`: `VBUS` ⟷ `GND` (high-freq decoupling, close to IC)

**VDD Decoupling (Internal 4.7V Regulator):**
- `C30 (1µF ceramic)`: `VDD (pin 7)` ⟷ `GND` (internal regulator output)

**Voltage Configuration (15V Selection):**
- `CH224D pin 1 (DRV)` → Connected to `pin 19 (CFG1)`
- `CFG1` → `R11 (56kΩ, ±0.1%)` → `GND`
- `CH224D pin 13 (CFG2)` → `Open` or `GND`
- `CH224D pin 12 (CFG3)` → `Open` or `GND`

**LED Status Indicator Circuit:**
- `+5V rail (from Diagram7)` → `R10 (330Ω)` → `LED1 (Green LED)` → `CH224D pin 8 (PG)` → `GND`
- LED indicates: **Power Good** (lights up when 15V USB-PD negotiation succeeds)
- LED current: `I = (5V - 2.2V) / 330Ω ≈ 8.5mA` ✅
- **Note**: PG pin is open-drain, pulls LOW when power is good

**PD-Only Mode Configuration:**
- `CH224D pin 8 (DP)` ↔ `pin 9 (DM)` - **Shorted together** (disables BC1.2 and other USB data protocols)
- **Why short DP to DM?** 6-pin USB-C connector has no DP/DM pins. Per datasheet, we must short DP to DM on CH224D to use PD-only mode.
- `CH224D pin 18` - NC (Not Connected in datasheet)

**Internal Switch Configuration:**
- `CH224D pin 5 (GATE)` - Drives internal NMOS gate (no external connection)
- `CH224D pin 6 (NMOS#)` → `GND` (enables internal switch mode, disables external MOSFET control)

**Current Sensing Configuration:**
- `CH224D pin 14 (ISP)` ↔ `pin 15 (ISN)` - **Shorted together** → `GND`
- Not using current sensing feature (CH224D provides overcurrent protection internally)

</details>

## Diagram2: USB-PD +15V → +13.5V Buck Converter (LM2596S-ADJ #1)

<BuckU2Diagram />

<details>
<summary>Connection List</summary>

**Input Power:**
- `+15V input` → `U2 (LM2596S-ADJ) pin 1 (VIN)`
- `GND` → `U2 pin 5 (ON/OFF)` (always-on: tie to GND or leave floating)

**Output Path (Buck Converter Topology):**
1. `U2 pin 2 (OUTPUT)` → `L1 (100µH, 4.5A)` → Junction point
2. Junction point → `C3 (470µF/25V)` → `GND` (output filter capacitor)
3. Junction point → `+13.5V output` (to next stage)

**Flyback Diode (Freewheeling Diode):**
- `D1 (SS34 Schottky)`:
  - Cathode → Junction between `OUTPUT (pin 2)` and `L1`
  - Anode → `GND`
  - Purpose: Provides path for inductor current when switch turns off

**Input Capacitors:**
- `C5 (100µF electrolytic)`: `+15V input` ⟷ `GND` (bulk input filter)
- `C6 (100nF ceramic)`: `+15V input` ⟷ `GND` (high-frequency decoupling)

**Output Capacitor:**
- `C3 (470µF/25V electrolytic)`: Connected **in parallel** between `+13.5V output` ⟷ `GND`
- Purpose: Output filtering, ripple reduction, and energy storage for transient response
- **Important**: C3 is NOT in series with the output - it's a shunt element that allows AC ripple current to flow to GND

**Feedback Network (Voltage Setting):**
- Voltage divider: `+13.5V output` → `R1 (10kΩ)` → **Tap point** → `R2 (1kΩ)` → `GND`
- `U2 pin 4 (FB)` → Connected to **tap point** (junction between R1 and R2)
- The tap point voltage = `13.5V × R2/(R1+R2) = 13.5V × 1kΩ/11kΩ = 1.23V`
- Chip maintains FB pin at 1.23V by adjusting duty cycle
- Output voltage formula: `VOUT = 1.23V × (1 + R1/R2) = 1.23V × (1 + 10kΩ/1kΩ) = 13.53V`

**Ground:**
- `U2 pin 3 (GND)` → `System GND`
- All capacitor negative terminals → `System GND`
- `D1 anode` → `System GND`

**Key Points:**
- The inductor L1 is on the **OUTPUT side** of pin 2 (OUTPUT), not the input side
- D1 cathode connects to the junction between OUTPUT (pin 2) and L1 (the "switching node")
- When U2's internal switch is ON: Current flows VIN → Switch → OUTPUT → L1 → C3 → Load
- When U2's internal switch is OFF: Inductor current flows through D1 (L1 → D1 → GND → L1)

</details>

## Diagram3: +15V → +7.5V Buck Converter (LM2596S-ADJ #2, U3)

<BuckU3Diagram />

<details>
<summary>Connection List</summary>

**Input Power:**
- `+15V input` → `U3 (LM2596S-ADJ) pin 1 (VIN)`
- `GND` → `U3 pin 5 (ON/OFF)` (always-on: tie to GND or leave floating)

**Output Path (Buck Converter Topology):**
1. `U3 pin 2 (OUTPUT)` → `L2 (100µH, 4.5A)` → Junction point
2. Junction point → `C4 (470µF/25V)` → `GND` (output filter capacitor)
3. Junction point → `+7.5V output` (to L7805 linear regulator)

**Flyback Diode (Freewheeling Diode):**
- `D2 (SS34 Schottky)`:
  - Cathode → Junction between `OUTPUT (pin 2)` and `L2`
  - Anode → `GND`
  - Purpose: Provides path for inductor current when switch turns off

**Input Capacitors:**
- `C5 (100µF electrolytic)`: `+15V input` ⟷ `GND` (bulk input filter, shared with U2)
- `C6 (100nF ceramic)`: `+15V input` ⟷ `GND` (high-frequency decoupling, shared with U2)

**Output Capacitor:**
- `C4 (470µF/25V electrolytic)`: Connected **in parallel** between `+7.5V output` ⟷ `GND`
- Purpose: Output filtering, ripple reduction, and energy storage for transient response
- **Important**: C4 is NOT in series with the output - it's a shunt element that allows AC ripple current to flow to GND

**Feedback Network (Voltage Setting):**
- Voltage divider: `+7.5V output` → `R3 (5.1kΩ)` → **Tap point** → `R4 (1kΩ)` → `GND`
- `U3 pin 4 (FB)` → Connected to **tap point** (junction between R3 and R4)
- The tap point voltage = `7.5V × R4/(R3+R4) = 7.5V × 1kΩ/6.1kΩ = 1.23V`
- Chip maintains FB pin at 1.23V by adjusting duty cycle
- Output voltage formula: `VOUT = 1.23V × (1 + R3/R4) = 1.23V × (1 + 5.1kΩ/1kΩ) = 7.5V`

**Ground:**
- `U3 pin 3 (GND)` → `System GND`
- All capacitor negative terminals → `System GND`
- `D2 anode` → `System GND`

**Key Points:**
- The inductor L2 is on the **OUTPUT side** of pin 2 (OUTPUT), not the input side
- D2 cathode connects to the junction between OUTPUT (pin 2) and L2 (the "switching node")
- When U3's internal switch is ON: Current flows VIN → Switch → OUTPUT → L2 → C4 → Load
- When U3's internal switch is OFF: Inductor current flows through D2 (L2 → D2 → GND → L2)
- This stage provides +7.5V to the L7805 linear regulator for final +5V output

</details>

## Diagram4: +15V → -15V Voltage Inverter (ICL7660, U5)

```
                                          ┌───────────┐
                    ┌──────────────────┐  │           │
                    │                  │  │ C12 (10µF)│
                    │1  NC       CAP+ 2├──┤  Ceramic  │
                    │                  │  │           │
GND ────────────────┤3  GND            │  └─────┬─────┘
                    │                  │        │
                    │   ICL7660M/TR    │        │
                    │                  │        │
                    │            CAP- 4├────────┘
                    │                  │
                    │            VOUT 5├──────── -15V OUT
                    │                  │
                    │6  LV             │
                    │                  │
                    │7  OSC            │
                    │                  │
+15V ───────────────┤8  V+             │
                    │                  │
                    └──────────────────┘

NOTE: C12 flying capacitor connects between Pin 2 (CAP+) and Pin 4 (CAP-)
      Pin 5 (VOUT) outputs the inverted voltage (-15V)
      Pin 8 is the ONLY V+ input pin

Output Filter Capacitor (connected in parallel):
-15V OUT ────┬───────────── To next stage
             │
           C13 (10µF)
             │
            GND
```

<details>
<summary>Connection List</summary>

**Power Lines:**
- `+15V input` → `U5 (ICL7660M) pin 8 (V+)`
- `U5 pin 5 (VOUT)` → `-15V output`

**Charge Pump Capacitors:**
- `C12 (10µF Ceramic)`: `U5 pin 2 (CAP+)` ⟷ `U5 pin 4 (CAP-)` (flying capacitor)
- `C13 (10µF Ceramic)`: `-15V output` ⟷ `GND` (output filter)

**Control Pins:**
- `U5 pin 6 (LV)` → `Open` (normal voltage mode, not low voltage)
- `U5 pin 7 (OSC)` → `Open` (10kHz internal oscillator)

**Ground:**
- `U5 pin 3 (GND)` → `System GND`

**Operation:**
- Charge pump switches `C12` between `+15V` and `GND` to generate `-15V`
- Output voltage: `VOUT ≈ -(VIN - 1V) = -14V typical`

</details>

## Diagram5: -15V → -13.5V Buck Converter (LM2596S-ADJ #3, U4)

```
LM2596S-ADJ IC:
                    ┌──────────────┐
-15V ───────────────┤1 VIN     OUT 2├───── SW Node
                    │              │
                 ┌──┤3 GND      FB 4├──── FB Tap
                 │  │              │
                GND │    5 ON/OFF  │
                    │   (floating) │
                    └──────────────┘

Switching Node and Inductor:
                                 ┌─────────────┐
SW Node ────────────┬────────────┤ L3 (100µH)  ├──────────── -13.5V OUT
                    │            └─────────────┘
                    │
                    └─── D3 (SS34 Schottky)
                         Cathode
                            │
                         Anode
                            │
                           GND

Input Filter Capacitors:
-15V ───┬─── To VIN
        │
        ├─ C9 (100µF electrolytic)
        │    │  ※ Negative to -15V, Positive to GND
        │   GND
        │
        └─ C10 (100nF ceramic)
             │
            GND

Feedback Voltage Divider:
-13.5V OUT ─┬─── Output
            │
            ├─ R5 (10kΩ)
            │    │
            │ FB Tap ─── To FB Pin 4
            │    │
            ├─ R6 (1kΩ)
            │    │
            │   GND
            │
            └─ C11 (470µF electrolytic)
                 │  ※ Negative to -13.5V, Positive to GND
                GND
```

<details>
<summary>Connection List</summary>

**Input Power:**
- `-15V input` → `U4 (LM2596S-ADJ) pin 1 (VIN)`
- `U4 pin 5 (ON/OFF)` → Left floating (internal pull-up enables regulator)
- `U4 pin 3 (GND)` → `System GND`

**Output Path (Buck Converter Topology):**
1. `U4 pin 2 (OUT)` → `L3 (100µH, 4.5A)` → Junction point
2. Junction point → `C11 (470µF/25V)` → `GND` (output filter capacitor)
3. Junction point → `-13.5V output` (to LM7912 linear regulator)

**Flyback Diode:**
- `D3 (SS34 Schottky)`:
  - Cathode → Junction between `OUT (pin 2)` and `L3`
  - Anode → `GND`

**Input Capacitors:**
- `C9 (100µF electrolytic)`: `-15V input` ⟷ `GND` (bulk input filter)
  - Polarity: Negative terminal to `-15V`, positive terminal to `GND`
- `C10 (100nF ceramic)`: `-15V input` ⟷ `GND` (high-frequency decoupling)

**Output Capacitor:**
- `C11 (470µF/25V electrolytic)`: Connected **in parallel** between `-13.5V output` ⟷ `GND`
  - Polarity: Negative terminal to `-13.5V`, positive terminal to `GND`
- Purpose: Output filtering, ripple reduction, and energy storage for transient response
- **Important**: C11 is NOT in series with the output - it's a shunt element that allows AC ripple current to flow to GND

**Feedback Network:**
- Voltage divider: `-13.5V output` → `R5 (10kΩ)` → **Tap point** → `R6 (1kΩ)` → `GND`
- `U4 pin 4 (FB)` → Connected to **tap point** (junction between R5 and R6)
- The tap point voltage = `-13.5V × R6/(R5+R6) = -13.5V × 1kΩ/11kΩ = -1.23V`
- Chip maintains FB pin at 1.23V below GND by adjusting duty cycle
- Output voltage formula: `VOUT = -1.23V × (1 + R5/R6) = -1.23V × (1 + 10kΩ/1kΩ) = -13.53V`

**Important Notes:**
- All voltages are negative and referenced to GND (0V)
- Electrolytic capacitors must have correct polarity (negative terminal to negative voltage)
- The buck converter topology is identical to positive voltage versions, just with negative voltages

</details>

## Diagram6: +13.5V → +12V Linear Regulator (L7812, U6)

```
Regulator IC:
                    ┌──────────────────┐
+13.5V IN ──────────┤1 IN         OUT 3├──────────── +12V OUT
                    │                  │
                 ┌──┤2 GND             │
                 │  └──────────────────┘
                GND      LM7812
                        (TO-263-2)

Input Capacitors (C14 closest to IC):
+13.5V ──┬────────────────┬─── To IC Pin 1
         │                │
        C20              C14
       470µF            470nF
    electrolytic       ceramic
     (farther)        (CLOSE!)
         │                │
        GND              GND

Output Capacitors (C17 closest to IC):
From IC Pin 3 ──┬────────────────┬─── +12V
                │                │
               C17              C21
              100nF            470µF
             ceramic        electrolytic
             (CLOSE!)        (farther)
                │                │
               GND              GND

Status LED:
+12V ──── R7 (1kΩ) ──── LED2 (Green) ──── GND
```

**Capacitor Placement (Critical for PCB layout):**
- **C14/C17 (ceramic)**: Place RIGHT NEXT to IC pins (minimize trace length for high-freq filtering)
- **C20/C21 (electrolytic)**: Can be placed farther from IC (bulk storage, less sensitive to distance)

<details>
<summary>Connection List</summary>

**Regulator:**
- U6 (L7812CD2T-TR): `+13.5V input` → Pin 1 (IN), Pin 3 (OUT) → `+12V output`, Pin 2 (GND) → `GND`

**Input Capacitors (connected in parallel between +13.5V and GND):**
- C14 (470nF ceramic): High-frequency noise filtering
- C20 (470µF electrolytic): Input bulk stabilization

**Output Capacitors (connected in parallel between +12V and GND):**
- C17 (100nF ceramic): High-frequency decoupling
- C21 (470µF electrolytic): Output stabilization and transient response

**Status LED:**
- LED2 (Green): `+12V` → `R7 (1kΩ)` → `LED2 anode` → `LED2 cathode` → `GND`
- LED current: `I = (12V - 2V) / 1kΩ ≈ 10mA`

</details>

## Diagram7: +7.5V → +5V Linear Regulator (L7805, U7)

```
Regulator IC:
                    ┌──────────────────┐
+7.5V IN ───────────┤1 IN         OUT 3├──────────── +5V OUT
                    │                  │
                 ┌──┤2 GND             │
                 │  └──────────────────┘
                GND      LM7805
                        (TO-263-2)

Input Capacitors (C15 closest to IC):
+7.5V ───┬────────────────┬─── To IC Pin 1
         │                │
        C22              C15
       470µF            470nF
    electrolytic       ceramic
     (farther)        (CLOSE!)
         │                │
        GND              GND

Output Capacitors (C18 closest to IC):
From IC Pin 3 ──┬────────────────┬─── +5V
                │                │
               C18              C23
              100nF            470µF
             ceramic        electrolytic
             (CLOSE!)        (farther)
                │                │
               GND              GND

Status LED:
+5V ──── R8 (1kΩ) ──── LED3 (Blue) ──── GND
```

**Capacitor Placement:** Same as Diagram5 - ceramic caps close to IC, electrolytic caps can be farther

<details>
<summary>Connection List</summary>

**Regulator:**
- U7 (L7805ABD2T-TR): `+7.5V input` → Pin 1 (IN), Pin 3 (OUT) → `+5V output`, Pin 2 (GND) → `GND`

**Input Capacitors (connected in parallel between +7.5V and GND):**
- C15 (470nF ceramic): High-frequency noise filtering
- C22 (470µF electrolytic): Input bulk stabilization

**Output Capacitors (connected in parallel between +5V and GND):**
- C18 (100nF ceramic): High-frequency decoupling
- C23 (470µF electrolytic): Output stabilization and transient response

**Status LED:**
- LED3 (Blue): `+5V` → `R8 (1kΩ)` → `LED3 anode` → `LED3 cathode` → `GND`
- LED current: `I = (5V - 2V) / 1kΩ = 3mA` (dim, consider 330Ω for brighter)

</details>

## Diagram8: -13.5V → -12V Linear Regulator (CJ7912, U8)

```
Regulator IC:
                    ┌──────────────────┐
-13.5V IN ──────────┤1 IN         OUT 2├──────────── -12V OUT
                    │                  │
                 ┌──┤3 GND             │
                 │  └──────────────────┘
                GND      LM7912
                        (TO-252-3)

Input Capacitors (C16 closest to IC):
-13.5V ──┬────────────────┬─── To IC Pin 1
         │                │
        C24              C16
       470µF            470nF
    electrolytic       ceramic
     (farther)        (CLOSE!)
    Polarity: - to
    -13.5V, + to GND
         │                │
        GND              GND

Output Capacitors (C19 closest to IC):
From IC Pin 2 ──┬────────────────┬─── -12V
                │                │
               C19              C25
              100nF            470µF
             ceramic        electrolytic
             (CLOSE!)        (farther)
            Polarity: - to
            -12V, + to GND
                │                │
               GND              GND

Status LED (reversed polarity for negative rail):
GND ──── LED4 Anode (Red) ──── LED4 Cathode ──── R9 (1kΩ) ──── -12V
```

**Capacitor Placement:** Same as Diagram5 - ceramic caps close to IC, electrolytic caps can be farther
**Important:** Electrolytic polarity for negative rail: Negative terminal to negative voltage, Positive terminal to GND

<details>
<summary>Connection List</summary>

**Regulator:**
- U8 (CJ7912): `-13.5V input` → Pin 1 (IN), Pin 2 (OUT) → `-12V output`, Pin 3 (GND) → `GND`
- **Note:** LM7912 pinout differs from LM7812/7805: pin 1=IN, pin 2=OUT, pin 3=GND

**Input Capacitors (connected in parallel between -13.5V and GND):**
- C16 (470nF ceramic): High-frequency noise filtering
- C24 (470µF electrolytic): Input bulk stabilization
  - **Polarity:** Negative terminal to `-13.5V`, Positive terminal to `GND`

**Output Capacitors (connected in parallel between -12V and GND):**
- C19 (100nF ceramic): High-frequency decoupling
- C25 (470µF electrolytic): Output stabilization and transient response
  - **Polarity:** Negative terminal to `-12V`, Positive terminal to `GND`

**Status LED:**
- LED4 (Red): `GND` → `LED4 anode` → `LED4 cathode` → `R9 (1kΩ)` → `-12V`
- LED current: `I = (0V - (-12V) - 2V) / 1kΩ = 10mA`
- **Note:** LED is reversed compared to positive rails (anode to GND, cathode to negative voltage)

</details>

## Diagram9: Protection Circuit (PTC Auto-Reset with Multi-Layer Protection)

```
+12V Rail Protection (1.2A target, 1.5A max):

+12V IN ─── PTC1 ───┬─→ +12V OUT
       SMD1210P150  │
       (1.5A hold)  │
       (3A trip)    │
                    │
                   ┌┴┐ TVS1 (SMAJ15A)
                   │ │ Cathode up
                   └┬┘ Anode down
                    │
                   GND

Status Indicator:
+12V OUT ─── R7 ─── LED2 ─── GND
           (1kΩ)  (Green)

Protection Layers:
  1. LM7812 current limiting (~2.2A max, immediate) ✅
  2. LM7812 thermal shutdown (150°C, 1-5s) ✅
  3. PTC1 trips (>3A, 0.5-5s) → Auto-reset after 30-60s ✅
  4. USB-PD adapter protection (backup) ✅


+5V Rail Protection (0.5A target, 1A max):

+5V IN ─── PTC2 ───┬─→ +5V OUT
      mSMD110-33V  │
      (1.1A hold)  │
      (2.2A trip)  │
                   │
                  ┌┴┐ TVS2 (PRTR5V0U2X)
                  │ │ Bidirectional
                  └┬┘
                   │
                  GND

Status Indicator:
+5V OUT ─── R8 ─── LED3 ─── GND
          (1kΩ)  (Blue)

Protection Layers:
  1. LM7805 current limiting (~1A max, immediate) ✅
  2. LM7805 thermal shutdown (150°C, 1-5s) ✅
  3. PTC2 trips (>2.2A, 1-5s) → Auto-reset after 30-60s ✅
  4. USB-PD adapter protection (backup) ✅


-12V Rail Protection (0.8A target, 1A max):

-12V IN ─── PTC3 ───┬─→ -12V OUT
     JK-nSMD100/16  │
     (1.0A hold)    │
     (2.0A trip)    │
                    │
                   ┌┴┐ TVS3 (SMAJ15A)
                   │ │ Anode up (reversed)
                   └┬┘ Cathode down
                    │
                   GND

Status Indicator (reversed for negative rail):
GND ─── LED4 ─── R9 ─── -12V OUT
      (Red)   (1kΩ)

Protection Layers:
  1. LM7912 current limiting (~1A max, immediate) ✅
  2. LM7912 thermal shutdown (150°C, 1-5s) ✅
  3. PTC3 trips (>2.0A, 1-5s) → Auto-reset after 30-60s ✅
  4. USB-PD adapter protection (backup) ✅


Design Philosophy:
※ Four-layer protection: USB-PD → DC-DC → Linear Regulator → PTC
※ Linear regulators provide current limiting (prevents catastrophic shorts)
※ PTCs provide auto-reset convenience (no manual fuse replacement)
※ TVS diodes protect against overvoltage transients
※ If LED goes out → overload → reduce modules and wait 60 seconds for auto-reset

Selected Parts:
※ PTC1: C7529589 (SMD1210P150TF/16) - 1.5A hold, 3A trip, SMD1210
※ PTC2: C70119 (mSMD110-33V) - 1.1A hold, 2.2A trip, 1812
※ PTC3: C2830246 (JK-nSMD100/16V) - 1.0A hold, 2.0A trip, 1206
※ TVS1/3: SMAJ15A (unidirectional, 15V)
※ TVS2: PRTR5V0U2X (bidirectional, 5V)
```

<details>
<summary>Connection List</summary>

**+12V Rail Protection:**
- `+12V input (from LM7812)` → `PTC1 (C7529589, 1.5A hold)` → `+12V OUT`
- `TVS1 (SMAJ15A)`: Cathode to `+12V OUT`, Anode to `GND` (clamps overvoltage)
- `LED2 (Green)` + `R7 (1kΩ)`: Between `+12V OUT` and `GND` (status indicator)

**+5V Rail Protection:**
- `+5V input (from LM7805)` → `PTC2 (C70119, 1.1A hold)` → `+5V OUT`
- `TVS2 (PRTR5V0U2X)`: Bidirectional protection to `GND` (clamps overvoltage)
- `LED3 (Blue)` + `R8 (1kΩ)`: Between `+5V OUT` and `GND` (status indicator)

**-12V Rail Protection:**
- `-12V input (from LM7912)` → `PTC3 (C2830246, 1.0A hold)` → `-12V OUT`
- `TVS3 (SMAJ15A)`: Anode to `-12V OUT`, Cathode to `GND` (reversed for negative rail)
- `LED4 (Red)` + `R9 (1kΩ)`: Between `GND` and `-12V OUT` (status indicator, reversed)

**Protection Operation:**
1. **Normal operation (&lt;hold current):**
   - PTC: Low resistance (0.03-0.05Ω), minimal voltage drop
   - Linear regulator: Normal operation
   - LED: Illuminated, indicates power present

2. **Moderate overload (hold current to trip current):**
   - PTC heats up and resistance increases
   - Linear regulator may enter current limiting
   - Within 1-5 seconds: PTC trips
   - Current drops to ~10mA
   - LED dims or turns off (indicates overload)
   - Auto-resets after 30-60 seconds when cooled

3. **Short circuit (>trip current):**
   - Linear regulator current limiting activates IMMEDIATELY (limits to ~1-2A)
   - PTC heats rapidly due to limited current
   - Within 0.5-5 seconds: PTC trips
   - If sustained: Linear regulator thermal shutdown (150°C)
   - LED turns off
   - Auto-resets after cooling (both PTC and regulator)

**Multi-Layer Protection:**
1. **Layer 1 (USB-PD)**: Input overcurrent protection
2. **Layer 2 (DC-DC)**: LM2596 current limiting (~3-5A)
3. **Layer 3 (Linear Reg)**: Current limiting (~1-2A, immediate) + thermal shutdown (1-5s)
4. **Layer 4 (PTC)**: Auto-reset overcurrent protection (0.5-5s trip time)

**TVS Diode Operation:**
- Normally off (high impedance)
- Activates when voltage exceeds breakdown (15V for SMAJ15A, 5V for PRTR5V0U2X)
- Shunts overvoltage transients to GND
- Self-recovering (no replacement needed)

**Key Insight:**
Linear regulators prevent catastrophic shorts by limiting current to safe levels before PTC trips, making PTC-only protection adequate for this application.

</details>

## Diagram10: Power Flow Overview

```
USB-C 15V ──┬─→ +13.5V (DC-DC) ──→ +12V (LDO) ──→ +12V OUT
            │
            ├─→ +7.5V  (DC-DC) ──→ +5V  (LDO) ──→ +5V OUT
            │
            └─→ -15V (Inverter) ──→ -13.5V (DC-DC) ──→ -12V (LDO) ──→ -12V OUT
```
