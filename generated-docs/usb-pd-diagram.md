# USB-PD 15V電源回路（CH224Q + 状態表示LED）

## 🔧 完全版回路図

```
USB-C コネクタ                    CH224Q (DFN-10-EP)         LED状態表示回路
┌─────────────┐                ┌──────────────┐            
│VBUS (B9,A9) ├──┬─────────────┤1. VHV        │            USB-C VBUS
│             │  │             │8. VBUS       │─┬─→ 15V出力      │
│CC1 (A5)     ├──┼─────────────┤7. CC1        │ │              1kΩ (R1)
│CC2 (B5)     ├──┼─────────────┤6. CC2        │ │                │
│GND (B12,A12)├──┼─────────────┤GND           │ │            赤色LED
└─────────────┘  │             │11. EP        │←┘             (LED1)
                 │             │              │                 │
               ┌─C1            │9. CFG1       │←── GND          │
               │ 10µF/25V      │2. CFG2/SCL   │←── Open         │
               │               │3. CFG3/SDA   │←── Open         │
               └─┬───          │10. PG        │─────────────────┘
                 │             │4. DP         │    (接続なし)
               ┌─C2            │5. DM         │    (接続なし)
               │ 10µF/25V      └──────────────┘
               │                      │
               └─┬────────────────────┘
                 │
                GND
```

## 📋 部品表（完全版）

### 主要部品
| 記号 | 部品番号 | メーカー品番 | 説明 | パッケージ | 価格 |
|------|----------|-------------|------|------------|------|
| U1 | **C9900166627** | **CH224Q** | USB PD Controller | DFN-10-EP | **$0.394** |
| J1 | **C2927029** | **USB-TYPE-C-009** | 6P Type-C Female | SMD | **$0.036** |

### 受動部品
| 記号 | 部品番号 | メーカー品番 | 説明 | パッケージ | 価格 |
|------|----------|-------------|------|------------|------|
| C1, C2 | **C15850** | **CL21A106KAYNNNE** | 10µF 25V X5R | 0805 | **$0.0101 × 2** |
| R1 | **C23138** | **0603WAF3300T5E** | 330Ω ±1% | 0603 | **$0.00099** |
| LED1 | **C84256** | **NCD0805R1** | 赤色LED 25mA | 0805 | **$0.0126** |

## ⚡ 回路動作説明

### 電源供給フロー
1. **USB-C接続時**: VBUS=5V → VHV(Pin1)
2. **PD交渉開始**: CFG設定(15V)を読み取り
3. **電圧要求**: CC線経由で15V要求送信
4. **電圧切替**: VBUS 5V→15V切替
5. **出力安定**: VBUS(Pin8)から15V出力

### LED状態表示
```
🔴 LED点灯 (PG=LOW): PD交渉成功、15V出力中
⚫ LED消灯 (PG=HIGH): PD交渉失敗または未接続

回路接続:
VDD → 330Ω抵抗 → LED(アノード) → LED(カソード) → PG(Pin10)
```

### コンデンサ機能
```
C1 (VHV-GND): 入力ノイズ除去、電圧切替時安定化
C2 (VBUS-GND): 出力リップル除去、負荷応答改善
```

## 🔌 ピン接続詳細

### CH224Q ピン接続
| ピン番号 | ピン名 | 接続先 | 機能 |
|----------|--------|--------|------|
| 1 | VHV | USB-C VBUS + C1 | 電源入力 |
| 2 | CFG2/SCL | Open | 電圧設定 |
| 3 | CFG3/SDA | Open | 電圧設定 |
| 4 | DP | NC | データ線（未使用） |
| 5 | DM | NC | データ線（未使用） |
| 6 | CC2 | USB-C CC2 | USB-PD通信 |
| 7 | CC1 | USB-C CC1 | USB-PD通信 |
| 8 | VBUS | 15V出力 + C2 | 安定化出力 |
| 9 | CFG1 | GND | 15V設定 |
| 10 | PG | LED回路 | 状態出力 |
| 11 | EP | GND | 放熱パッド |

### USB-C コネクタ接続
| ピン | 機能 | 接続先 |
|------|------|--------|
| A5/B5 | CC1/CC2 | CH224Q CC1/CC2 |
| A9/B9 | VBUS | CH224Q VHV |
| A12/B12 | GND | CH224Q GND/EP |

## 💰 総コスト計算

| 項目 | 単価 | 数量 | 小計 |
|------|------|------|------|
| CH224Q | $0.394 | 1 | $0.394 |
| USB-C コネクタ | $0.036 | 1 | $0.036 |
| 10µF コンデンサ | $0.0101 | 2 | $0.0202 |
| 330Ω 抵抗 | $0.00099 | 1 | $0.00099 |
| 赤色LED | $0.0126 | 1 | $0.0126 |
| **合計** | | | **$0.464** |

## 🎯 設計のポイント

### 1. 電圧安全性
- コンデンサ25V定格 (15V使用で1.67倍マージン)
- PD切替時の過渡現象にも対応

### 2. 状態監視
- PD交渉成功時：赤LED点灯
- 異常時：LED消灯で即座に判別可能

### 3. 実装性
- 全てSMD部品、0402〜1206サイズ
- Basic Parts使用で追加費用なし
- 豊富な在庫で安定調達

### 4. 拡張性
- DP/DM端子あり（将来のデータ通信対応）
- I2C端子あり（動的電圧制御対応）

## 🔄 次のステップ
この15V電源をDC-DCコンバータで他の電圧に変換する段階2の設計へ進む